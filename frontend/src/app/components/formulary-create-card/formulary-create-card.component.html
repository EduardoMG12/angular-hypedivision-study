<div class="p-6 mx-auto w-full bg-wood-smoke text-santas-gray border border-charade rounded-lg shadow-xl">
  <h2 class="text-xl font-bold text-alabaster">Detalhes do Card</h2>
  <p class="mb-6 text-gray-400">Preencha os detalhes abaixo para criar seu card de estudo.</p>

  <form [formGroup]="cardForm" (ngSubmit)="onSave()">

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <div class="flex flex-col">
        <div class="flex flex-col mb-4">
          <label for="title" class="mb-1 font-semibold text-alabaster">Título</label>
          <input type="text" id="title" formControlName="title" placeholder="Ex: Verbos Irregulares em Inglês"
            class="p-2 border border-charade bg-cinder rounded-lg text-santas-gray text-base w-full">
          <div *ngIf="cardForm.get('title')?.invalid && cardForm.get('title')?.touched"
            class="text-red-400 text-sm mt-1">
            Título é obrigatório.
          </div>
        </div>

      </div>

      <div class="flex flex-col">
        <div class="flex flex-col mb-4">
          <label for="type" class="mb-1 font-semibold text-alabaster">Tipo de Conteúdo</label>
          <select id="type" formControlName="type"
            class="p-2 border border-charade bg-cinder rounded-lg text-santas-gray text-base w-full appearance-none pr-8">
            <option *ngFor="let type of contentTypes" [value]="type.value" [disabled]="!type.enabled">
              {{ type.label }}
            </option>
          </select>
        </div>
      </div>
    </div>
    <div class="flex flex-col mb-4 w-full">
      <label for="description" class="mb-1 font-semibold text-alabaster">Descrição</label>
      <textarea id="description" formControlName="description" placeholder="Descreva o propósito deste card..."
        class="p-2 border border-charade bg-cinder rounded-lg text-santas-gray text-base w-full resize-y min-h-[80px]"></textarea>
    </div>

    <div class="flex flex-col col-span-full mt-6 border rounded-lg border-charade p-4" formGroupName="contentDetails">
      <h3 class="text-lg font-semibold text-alabaster mb-4">Conteúdo do Card</h3>

      <div *ngIf="selectedContentType === 'flip'">
        <div class="flex flex-col mb-4">
          <label for="front" class="mb-1 font-semibold text-alabaster">Frente do Card</label>
          <textarea id="front" formControlName="front" placeholder="O que aparecerá na frente do card ..."
            class="p-2 border border-charade bg-cinder rounded-lg text-santas-gray text-base w-full resize-y min-h-[80px]"></textarea>
          <div *ngIf="cardForm.get('contentDetails.front')?.invalid && cardForm.get('contentDetails.front')?.touched"
            class="text-red-400 text-sm mt-1">
            Campo Frente é obrigatório para Card Flip.
          </div>
        </div>

        <div class="flex flex-col mb-4">
          <label for="back" class="mb-1 font-semibold text-alabaster">Verso do Card</label>
          <textarea id="back" formControlName="back" placeholder="O que aparecerá quando o card for virado ..."
            class="p-2 border border-charade bg-cinder rounded-lg text-santas-gray text-base w-full resize-y min-h-[80px]"></textarea>
          <div *ngIf="cardForm.get('contentDetails.back')?.invalid && cardForm.get('contentDetails.back')?.touched"
            class="text-red-400 text-sm mt-1">
            Campo Verso é obrigatório para Card Flip.
          </div>
        </div>
      </div>

    </div>


    <div class="flex flex-col col-span-full mt-6 border rounded-lg border-charade p-4 ">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold text-alabaster">Tags</h3>
        <div class="relative group flex items-center">
          <div class="rounded-lg hover:bg-portage p-1">
            <app-info-icon />
          </div>
          <div class="absolute w-64 bg-wood-smoke border border-charade text-santas-gray text-sm text-start rounded-lg px-3 py-2
            bottom-full mb-2 left-1/2 -translate-x-1/2
            opacity-0 group-hover:opacity-100 transition-opacity duration-300
            z-10 pointer-events-none flex flex-col items-start justify-center">
            <p class="text-base">Para criar tags aninhadas, utilize "::" entre as palavras.</p>
            <p class="text-small">Exemplo:</p>
            <p class="text-small">programacao::js::function::teoria</p>
          </div>
        </div>
      </div>

      <div class="flex flex-col flex-wrap gap-2 mb-4 pl-5" formArrayName="tags">
        <span
          class="flex w-fit items-center bg-portage/20 text-base text-santas-gray px-3 py-2 border-charade rounded-lg textPurpleShadow"
          *ngFor="let tagControl of tags.controls; let i = index">
          {{ tagControl.value }}
          <button type="button" (click)="removeTag(i)"
            class="ml-1 text-portage cursor-pointer text-xs p-0 hover:text-alabaster">
            X
          </button>
        </span>
      </div>
      <div class="flex gap-3 mb-4 relative items-center">
        <input type="text" #tagInput placeholder="Adicionar tag..."
          (keydown.enter)="addTag(tagInput); $event.preventDefault()"
          class="p-2 border border-charade bg-cinder rounded-lg text-santas-gray text-base w-full flex-grow">


        <button type="button" (click)="addTag(tagInput)"
          class="px-4 py-2 bg-cinder border border-charade text-alabaster rounded-lg cursor-pointer text-lg leading-none hover:bg-portage">
          +
        </button>
      </div>

    </div>


    <div class="flex justify-end gap-4 mt-6  border-gray-700 pt-6">
      <button type="button" (click)="onCancel()"
        class="px-4 py-2 border border-charade rounded-lg cursor-pointer text-base bg-cinder text-alabaster ">
        Cancelar
      </button>
      <button type="button" (click)="onPreview()"
        class="px-4 py-2 border border-charade rounded-lg cursor-pointer text-base bg-cinder text-alabaster  flex flex-row items-center justify-center gap-4">
        <app-eye-icon [stroke]="'#FAFAFA'" />
        <p>
          Visualizar
        </p>
      </button>
      <button type="submit"
        class="px-4 py-2 border border-charade rounded-lg cursor-pointer text-base bg-portage/60 text-alabaster hover:bg-portage/80">
        Salvar Card
      </button>
      <button type="button" (click)="onSaveAndCreateNew()"
        class="px-4 py-2 border border-charade rounded-lg cursor-pointer text-base bg-portage/80 text-alabaster hover:bg-portage flex flex-row justify-center items-center gap-4">
        <app-plus-icon [stroke]="'#FAFAFA'" />
        <p>Salvar e Criar Outro</p>

      </button>
    </div>

  </form>
</div>